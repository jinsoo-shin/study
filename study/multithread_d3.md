# 멀티스레드

## 개요

> 스레드는 CPU 이용의 기본 단위
>
> 스레드는 같은 프로세스에 속한 다른 스레드와 코드, 데이터 섹션, 그리고 열린 파일이나 신호와 같은 운영체제 자원들을 공유한다.
>

>
> ## 동기(Motivation)
>
> 하나의 응용 프로그램은 몇 개의 제어 스레드를 가진 독립적인 프로세스로 구현된다.
>
> 웹 브라우저는 이미지 또는 텍스트를 표시하는 하나의 스레드와 네트워크로부터 데이터를 가져오는 또 다른 스레드를 가질 수 있다.
>
> 
>
> 웹서버가 전통적인 싱글스레드 프로세스로 작동한다면, 클라이언트는 자신의 요구가 서비스되기까지 매우 긴 시간을 기다려야 한다.
>
> 웹서버가 멀티스레드화가 되면, 서버는 클라이언트의 요청을 listen하는 별도의 스레드를 생성한다.
>
> 
>
> ## 멀티스레드 프로그래밍의 이점
>
> 1. 응답성
>    응용 프로그램의 일부분이 봉쇄되거나, 긴 작업을 실행하더라도 프로그램의 실행이 계속되는 것을 허용하여 사용자에 대한 응답성을 증가시킨다.
> 2. 자원 공유
>    프로세스는 공유 메모리 또는 메시지 전달 기법을 통해서만 자원을 공유할 수 있지만,
>    스레드는 그들이 속한 프로세스의 자원들과 메모리를 공유한다.
>    코드와 데이터 공유의 이점은 한 응용 프로그램이 같은 주소 공간 내에 여러 개의 다른 작업을 하는 스레드를 가질 수 있다는 점이다.
> 3. 경제성
>    프로세스 생성을 위해 메모리와 자원을 할당하는 것은 비용이 많이 든다.
>    스레드는 자신이 속한 프로세스의 자원들을 공유하기 때문에 스레드를 생성하는 것이 더 경제적이다.
>    일반적으로 스레드를 사용하는 것보다 새로운 프로세스를 생성하고 관리하는 것이 더 많은 시간을 소모한다.
> 4. 규모 가변성
>    멀티스레드의 이점은 다중처리기(멀티 프로세스) 구조에서 더욱 증가한다.
>    멀티프로세스 구조에서는 각각의 스레드가 다른 프로세스에서 병렬로 실행될 수 있기 때문이다.
>    멀티 CPU에서 멀티 스레딩은 병렬성을 증가시킨다.
>
> ## 멀티스레딩 모델
>
> 커널 스레드와 사용자 스레드의 연관 관계를 확립하는 방법
>
> 1. 다대일 모델 Many to One
>    하나의 커널 스레드 많은 사용자 수준 스레드
>    한번에 하나의 스레드만이 커널에 접근할 수 있어 멀티프로세스에서 돌아도 병렬로 작동할 수 없다.
>
> 2. 일대일 모델 One to One
>
>    하나의 스레드 하나의 커널 스레드
>    시스템에 의해 지원되는 스레드의 수를 제한한다.
>    Window와 Linux가 사용
>
> 3. 다대다 모델 Many to Many
>    여러 개의 사용자 수준 스레드, 같거나 작은 수의 커널 스레드
>
>    개발자가 필요한 만큼 많은 사용자 수준의 스레드를 생성할 수 있다
>
> ## 스레드와 관련된 문제들
>
> 멀티스레드 프로그램에서 고려해 할 문제들
>
> ### Fork(), Exec()
>
> fork()를 호출하면 새로운 프로세스는 모든 스레드를 복사하거나 fork()를 호출한 스레드만 복제한다.
>
> ### 취소
>
> 스레드가 끝나기 전에 그것을 강제 종료시키는 작업
>
> 여러 스레드들이 데이터베이스를 병렬로 검색하고 있다가 그 중 한 스레드가 결과를 찾았다면 나머지 스레드들은 취소되어도 된다.
>
> 이때 취소되어야 할 스레드를 목적 스레드라 부른다.
>
> 목적 스레드의 취소는
>
> 1. 비동기식 취소
>    한 스레드가 목적 스레드를 즉시 강제 종료시킨다.
> 2. 지연 취소
>    목적 스레드가 주기적으로 자신이 강제 종료하는지 검사한다.
>
> 
